$jason:
  head:
    title: Sonarr
    description: Sonarr is a PVR for Usenet and BitTorrent users
    icon: https://raw.githubusercontent.com/Sonarr/Sonarr/develop/Logo/128.png
    website:
      text: Click here to learn about Sonarr
      url: https://sonarr.tv/
    actions:
      $load:
        type: $network.request
        options:
          # Bug: Using $keys.base_url doesn't work for url
          url: https://grimspace.philipdouglass.com/sonarr/api/series
          headers:
            X-Api-Key: "{{$keys.api_key}}"
        success:
          type: $render
    templates:
      body:
        style:
          border: none
        nav:
          items:
            - type: tabs
              items:
                - text: Series
                  url: https://grimspace.philipdouglass.com/jason-clients/sonarr.json
                - text: Calendar
                  url: https://grimspace.philipdouglass.com/jason-clients/sonarr-calendar.json
                - text: Wanted
                  url: https://grimspace.philipdouglass.com/jason-clients/sonarr-wanted.json
            - type: menu
              image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAM1BMVEU\
                      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACjBUbJAAAA\
                      EHRSTlMAAQIVFyMqMlVrhZGiutri/MbJQAAAAE1JREFUOMvt0SkWACEMRMFmJ2zT9z/t2GBiQfBd5\
                      5ULsOVrgZmQ0QSdzA+cAi5l1SRF7wgMmhUsG1SE1lUfOfUW/35xLWhkMkFYw+2XH/GqCzkfRahHAA\
                      AAAElFTkSuQmCC"
              action:
                type: $widget.alert
                options:
                  title: Add Series
                  description: Enter a show name to search for
                  form:
                  - name: series_name
                    value: Name
                success:
                  # WIP: how do I make an action open a Jason view in the success callback?
                  type: href
                  url: https://grimspace.philipdouglass.com/jason-clients/sonarr-series-lookup.json
                  options:
                    series_name: "{{encodeURIComponent($json.series_name)}}"
        sections:
        - items:
            "{{#each $jason}}":
              type: image
              # WIP: how do I access $keys from inside the #each loop context?
              url: >-
                https://grimspace.philipdouglass.com/sonarr/api{{ images.filter(function(v){return
                ('coverType' in v) && v.coverType == 'banner'})[0].url }}&{{$keys.api_key}}
