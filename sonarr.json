{
  "$jason": {
    "head": {
      "title": "Sonarr", 
      "description": "Sonarr is a PVR for Usenet and BitTorrent users", 
      "icon": "https://raw.githubusercontent.com/Sonarr/Sonarr/develop/Logo/128.png", 
      "website": {
        "text": "Click here to learn about Sonarr", 
        "url": "https://sonarr.tv/"
      }, 
      "actions": {
        "$load": {
          "type": "$set", 
          "options": {
            "api_key": "{{$keys.api_key}}", 
            "base_url": "{{$keys.base_url}}", 
            "endpoint": "series"
          }, 
          "success": {
            "trigger": "fetch"
          }
        }, 
        "$pull": {
          "trigger": "fetch"
        }, 
        "fetch": {
          "type": "$network.request", 
          "options": {
            "url": "{{$get.base_url + '/' + $get.endpoint }}", 
            "headers": {
              "X-Api-Key": "{{$keys.api_key}}"
            }
          }, 
          "success": {
            "type": "$render"
          }
        }
      }, 
      "templates": {
        "body": {
          "style": {
            "border": "none"
          }, 
          "nav": {
            "items": [
              {
                "type": "tabs", 
                "items": [
                  {
                    "text": "Series", 
                    "url": "https://grimspace.philipdouglass.com/jason-clients/sonarr.json"
                  }, 
                  {
                    "text": "Calendar", 
                    "url": "https://grimspace.philipdouglass.com/jason-clients/sonarr-calendar.json"
                  }, 
                  {
                    "text": "Wanted", 
                    "url": "https://grimspace.philipdouglass.com/jason-clients/sonarr-wanted.json"
                  }
                ]
              }, 
              {
                "type": "menu", 
                "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAM1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACjBUbJAAAAEHRSTlMAAQIVFyMqMlVrhZGiutri/MbJQAAAAE1JREFUOMvt0SkWACEMRMFmJ2zT9z/t2GBiQfBd55ULsOVrgZmQ0QSdzA+cAi5l1SRF7wgMmhUsG1SE1lUfOfUW/35xLWhkMkFYw+2XH/GqCzkfRahHAAAAAElFTkSuQmCC", 
                "action": {
                  "type": "$widget.alert", 
                  "options": {
                    "title": "Add Series", 
                    "description": "Enter a show name to search for", 
                    "form": [
                      {
                        "name": "series_name", 
                        "value": "Name"
                      }
                    ]
                  }, 
                  "success": {
                    "type": "href", 
                    "url": "https://grimspace.philipdouglass.com/jason-clients/sonarr-series-lookup.json", 
                    "options": {
                      "series_name": "{{encodeURIComponent($json.series_name)}}"
                    }
                  }
                }
              }
            ]
          }, 
          "sections": [
            {
              "{{#if $get.endpoint=='series'}}": {
                "{{#each ['Continuing', 'Ended'].map(function(i) { return { status: i, series: $jason.filter(function(v) { return v.status == i.toLowerCase() }).map(function(j) { return Object.assign(j, { api_key: $get.api_key, base_url: $get.base_url }); }) } }) }}": {
                  "header": {
                    "type": "label", 
                    "text": "{{status + ' Series'}}", 
                    "style": {
                      "background": "#efefee", 
                      "font": "HelveticaNeue-Bold", 
                      "padding": "8", 
                      "size": "12"
                    }
                  }, 
                  "items": [
                    {
                      "type": "vertical", 
                      "style": {
                        "padding": "0"
                      }, 
                      "components": {
                        "{{#each series}}": {
                          "type": "image", 
                          "url": "{{ base_url + images.filter(function(v) { return ('coverType' in v) && v.coverType == 'banner' })[0].url + '&apikey=' + api_key }}", 
                          "style": {
                            "height": "140"
                          }, 
                          "action": {
                            "type": "$widget.toast", 
                            "options": {
                              "text": "This action is not being triggered"
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }, 
            {
              "{{#elseif /^series[/][0-9]+/.test($get.endpoint==)}}": {
                "header": {
                  "type": "label", 
                  "text": "{{ $get.endpoint }}"
                }
              }
            }, 
            {
              "{{#else}}": {
                "header": {
                  "type": "label", 
                  "text": "Something Else"
                }
              }
            }
          ]
        }
      }
    }
  }
}
